<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pixel art</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        flex-direction: column;
        align-items: center;
      }

      #grid {
        display: grid;
        height: 600px;
        width: 600px;
        margin-top: 40px;
        border: 1px solid lightgray;
      }

      .box {
        border: inherit;
      }

      .color-palette {
        margin-top: 40px;
        display: flex;
        gap: 30px;
      }

      .color {
        height: 60px;
        width: 60px;
        box-shadow: 0 0 3px 1px rgb(0 0 0 / 20%);
        transition: 0.3s all linear;
      }

      .color.active {
        transform: scale(1.3);
        box-shadow: 0 0 5px 2px rgb(0 0 0 / 20%);
      }

      .red {
        background-color: #ff1744;
      }

      .yellow {
        background-color: #ffea00;
      }

      .blue {
        background-color: #2979ff;
      }

      .green {
        background-color: #00e676;
      }

      .black {
        background-color: black;
      }

      .white {
        background-color: white;
      }
    </style>
  </head>
  <body>
    <div id="grid"></div>

    <div class="color-palette">
      <div class="color red" data-color="#ff1744"></div>
      <div class="color yellow" data-color="#ffea00"></div>
      <div class="color blue" data-color="#2979ff"></div>
      <div class="color green" data-color="#00e676"></div>
      <div class="color black active" data-color="black"></div>
      <div class="color white" data-color="white"></div>
    </div>

    <!-- <script src="script.js"></script> -->
    <script>
      new PixelArt("#grid", 10, 10);

      let selectedColor = "black";

      function PixelArt(el, rows, cols) {
        // Logic for generating grid layout
        let gridEle = document.querySelector(el);
        let fragment = document.createDocumentFragment();
        gridEle.style.grid = `repeat(${rows}, 1fr) / repeat(${cols}, 1fr)`;
        for (let i = 0; i < rows * cols; i++) {
          let div = document.createElement("div");
          div.addEventListener("click", applyColorOnClick);
          div.addEventListener("mousedown", onMouseDown);
          div.addEventListener("mousemove", onMouseMove);
          div.addEventListener("mouseup", onMouseUp);
          div.classList.add("box");
          fragment.appendChild(div);
        }
        gridEle.appendChild(fragment);

        // Color selection
        let colorBoxList = document.querySelectorAll(".color");
        for (let i = 0; i < colorBoxList.length; i++) {
          colorBoxList[i].addEventListener("click", selectColor);
        }
        function selectColor(event) {
          let dataset = event.target.dataset;
          selectedColor = dataset.color;
          toggleActiveColor();
          event.target.classList.add("active");
        }
        function toggleActiveColor() {
          for (let i = 0; i < colorBoxList.length; i++) {
            colorBoxList[i].classList.remove("active");
          }
        }

        // apply color on click
        function applyColorOnClick(event) {
          console.log("hi");
          let gridCellEle = event.target;
          gridCellEle.style.backgroundColor = selectedColor;
        }

        // apply color on keydown hover
        let isMouseDown = false;
        function onMouseDown(event) {
          isMouseDown = true;
        }

        function onMouseMove(event) {
          if (isMouseDown) {
            let gridCellEle = event.target;
            gridCellEle.style.backgroundColor = selectedColor;
          }
        }

        function onMouseUp(event) {
          isMouseDown = false;
        }
      }
    </script>
  </body>
</html>
